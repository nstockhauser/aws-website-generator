# WordPress Generator

This repository is a **two‑part automation sandbox** that demonstrates building and tearing down infrastructure using Python and Terraform on AWS.

It contains:

- **bootstrap/** – A Python automation lesson with scripts to generate and destroy Terraform backend configuration.
- **wordpress/** – Terraform configuration that deploys a WordPress server.

---

## 📦 Dependencies

Make sure these are installed at the system level before you begin:

- [Python](https://www.python.org/downloads/)
- [Terraform](https://developer.hashicorp.com/terraform/install)
- [pip](https://pip.pypa.io/en/stable/installation/)
- [AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html)
- [Git](https://git-scm.com/) _(optional but recommended)_

---

## 🏗️ Scripts Overview

### `bootstrap/generator.py`

- Uses **jinja2** to process `templates/providers.tf.j2`.
- Prompts for a region.
- Creates:
  - An S3 bucket for your Terraform backend.
  - A DynamoDB table for state locking.
  - A `providers.tf` in `wordpress/` with region-specific values.
- Picks a random default subnet in your chosen region.

### `bootstrap/teardown.py`

- Cleans up:
  - Removes the S3 bucket and DynamoDB table created during generation.
  - Deletes the generated `providers.tf` in `wordpress/`.
- Effectively **zeroizes** the repo for that region.

---

## 🚀 Standard Operating Procedure (SoP)

Before you run anything, make sure you’ve done these three things manually:

1. **AWS Account:**  
   Have an AWS account (Free Tier is fine).

2. **AWS User:**  
   Create a user with permissions and programmatic access credentials saved locally.

3. **Dependencies Installed:**  
   Ensure Python, Terraform, AWS CLI, and pip are installed.

---

### ✅ Step 1: Configure AWS Credentials

Run:

```bash
aws configure
```

Provide:

- Access Key & Secret Key
- Default region (not critical for deployment)
- Default output: `json`

---

### ✅ Step 2: Generate Terraform Backend

Navigate to the **bootstrap** folder:

```bash
cd bootstrap
python generator.py
```

The script will prompt for a region.  
**Requirements:**  
✅ Default VPC and related services must still exist in that region.

After running:

- S3 bucket and DynamoDB table are created.
- A customized `providers.tf` is written into `wordpress/`.

---

### ✅ Step 3: Deploy WordPress

Navigate to the **wordpress** folder:

```bash
cd ../wordpress
terraform init
terraform apply
# Type "yes" when prompted
```

Terraform will:

- Launch a WordPress server in the selected region.
- Lock down SSH access to **your public IP only**.
- Generate an ephemeral key pair in your local directory so you can SSH into the instance directly.
- Randomly pick a default subnet in that region.

---

### 🗑️ Step 4: Tear Down

To clean up:

1. **Destroy the WordPress deployment:**

```bash
terraform destroy
# Type "yes" when prompted
```

2. **Destroy the backend resources:**

```bash
cd ../bootstrap
python teardown.py
```

This will remove:

- S3 bucket and DynamoDB table.
- The generated `providers.tf` file.

---

## 📂 Project Structure

```bash
wordpress-generator/
├── README.md
├── bootstrap/
│   ├── generator.py
│   ├── teardown.py
│   ├── templates/
│   │   ├── providers.tf.j2
│   ├── userdata.sh
├── wordpress/
│   ├── data.tf
│   ├── main.tf
│   ├── outputs.tf
│   ├── providers.tf   # (Generated by generator.py)
```

---

## 🔧 Useful Commands

Get your public IP:

```bash
curl https://ipinfo.io/ip
```

---

## 🌱 Future Ideas

- Add **Apache web server** option (HTML/CSS/JS deployment).
- Add remove .terraform\* files from wordpress/
- make it site focused, so generate creates site folder and destrly relative to site.
- Cleanup README.md

---

**Enjoy automating! 🚀**
